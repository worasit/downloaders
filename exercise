Coding problem

Write a program that can be used to download data from multiple sources and protocols to local disk.
The list of sources will be given as input in the form of urls (e.g. http://my.file.com/file, ftp://other.file.com/other, sftp://and.also.this/ending etc)
The program should download all the sources, to a configurable location (file name should be uniquely determined from the url) and then exit.

in your code, please consider:
1.The program should extensible to support different protocols
2.some sources might very big (more than memory)
3.some sources might be very slow, while others might be fast
4.some sources might fail in the middle of download
5.we don't want to have partial data in the final location in any case.
You can implement the code Scala or Java and also include tests.

http : http://www.codejava.net/java-se/networking/use-httpurlconnection-to-download-file-from-an-http-url
ftp  : http://www.codejava.net/java-se/networking/ftp/java-ftp-file-download-tutorial-and-example
       http://www.iamrohit.in/create-ftp-server-using-nodejs/
sftp : http://stackoverflow.com/questions/14617/how-to-retrieve-a-file-from-a-server-via-sftp
       https://kodehelp.com/java-program-for-downloading-file-from-sftp-server/



       http://www.baeldung.com/java-read-lines-large-file
       http://tutorials.jenkov.com/java-nio/buffers.html
       http://stackoverflow.com/questions/236861/how-do-you-determine-the-ideal-buffer-size-when-using-fileinputstream
       http://jcommander.org -> CLI application for JAVA

       // Thread management
       http://crunchify.com/how-to-run-multiple-threads-concurrently-in-java-executorservice-approach/
       http://www.journaldev.com/1090/java-callable-future-example